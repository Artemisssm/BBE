# 约束类型最终定义

## 五种约束类型

### 1️⃣ 值范围约束 (VALUE_RANGE)
**功能**：限制目标参数的取值范围

**使用场景**：
- 编码方式为CONV时，码率范围为0.5~0.8
- 调制方式为BPSK时，符号率范围为1~100

**约束值格式**：`最小值,最大值`

**输入方式**：双数字输入框
```
[0.5] ~ [0.8]
```

**前端效果**：
- 动态调整目标参数的min/max范围
- 如果当前值超出范围，显示警告

**配置示例**：
```
约束条件：==CONV
约束值：0.5,0.8
效果：当编码方式为CONV时，码率范围限制为0.5~0.8
```

---

### 2️⃣ 固定值约束 (FIXED_VALUE)
**功能**：限制目标参数只能取某几个固定值

**使用场景**：
- 编码方式为CONV时，码率只能选择：0.5, 0.67, 0.75
- 调制方式为BPSK时，符号率只能选择：1, 2, 5, 10

**约束值格式**：`值1,值2,值3`（多个固定值，逗号分隔）

**输入方式**：
- 枚举类型：多选下拉框
- 数值类型：手动输入（逗号分隔）

```
枚举类型：
┌─────────────────────┐
│ [0.5, 0.67, 0.75] ▼ │
│ ☑ 0.5               │
│ ☑ 0.67              │
│ ☑ 0.75              │
└─────────────────────┘

数值类型：
[0.5,0.67,0.75]
```

**前端效果**：
- 目标参数只能选择这几个固定值
- 其他值不可输入或选择

**配置示例**：
```
约束条件：==CONV
约束值：0.5,0.67,0.75
效果：当编码方式为CONV时，码率只能选择0.5、0.67或0.75
```

---

### 3️⃣ 公式计算约束 (FORMULA_CALCULATE)
**功能**：根据公式自动计算目标参数值

**使用场景**：
- 符号率 = 数据率 / 2
- 输出功率 = 输入功率 + 增益
- 带宽 = 符号率 * (1 + 滚降系数)

**约束值格式**：公式表达式

**支持的变量**：
- `source` - 源参数值

**支持的运算**：
- 算术运算：`+` `-` `*` `/`
- 括号：`(` `)`

**公式示例**：
```
source * 2          → 源参数值乘以2
source + 10         → 源参数值加10
(source - 1) * 0.5  → (源参数值-1)乘以0.5
source / 2          → 源参数值除以2
```

**输入方式**：文本输入框
```
┌─────────────────────────┐
│ 公式 [source * 2      ] │
└─────────────────────────┘

提示：
- 支持的变量：source（源参数值）
- 支持的运算：+ - * / ( )
- 示例：source * 2 | source + 10
```

**前端效果**：
- 源参数变化时，自动计算目标参数值
- 目标参数变为只读（显示计算结果）

**配置示例**：
```
约束条件：（留空或任意条件）
约束值：source * 2
效果：目标参数值 = 源参数值 × 2
```

---

### 4️⃣ 枚举限制约束 (ENUM_LIMIT)
**功能**：限制枚举参数可选的选项，未选的置灰

**使用场景**：
- 编码方式为CONV时，码率下拉框只显示：0.5, 0.67, 0.75（其他选项置灰）
- 调制方式为BPSK时，符号率下拉框只显示：1, 2, 5, 10（其他选项置灰）

**约束值格式**：`值1,值2,值3`（允许的枚举值，逗号分隔）

**输入方式**：多选下拉框
```
┌─────────────────────────┐
│ [0.5, 0.67, 0.75]     ▼ │
│ ☑ 0.5                   │
│ ☑ 0.67                  │
│ ☑ 0.75                  │
│ ☐ 0.8                   │
│ ☐ 0.95                  │
└─────────────────────────┘
```

**前端效果**：
- 目标参数的下拉框中，只有选中的选项可用
- 未选中的选项显示为置灰状态，不可选择
- 如果当前值不在允许列表中，自动切换到第一个允许的值

**配置示例**：
```
约束条件：==CONV
约束值：0.5,0.67,0.75
效果：当编码方式为CONV时，码率下拉框只能选择0.5、0.67、0.75，其他选项置灰
```

**与固定值约束的区别**：
- 固定值约束：完全限制只能取这几个值
- 枚举限制约束：在枚举下拉框中，只有这几个选项可用，其他置灰

---

### 5️⃣ 控件禁用约束 (CONTROL_DISABLE)
**功能**：目标控件置灰不可操作

**使用场景**：
- ACM启用时，码率控件置灰不可操作
- 自动模式启用时，所有手动参数控件置灰
- 环回模式启用时，某些参数控件置灰

**约束值格式**：留空（不需要填写）

**输入方式**：禁用的输入框
```
┌─────────────────────────┐
│ [留空即可]            🔒 │
└─────────────────────────┘
提示：满足条件时目标控件将置灰
```

**前端效果**：
- 目标参数控件完全禁用（灰色）
- 不可编辑、不可选择
- 鼠标悬停显示禁用原因

**配置示例**：
```
约束条件：==1
约束值：（留空）
效果：当源参数为1时，目标控件置灰不可操作
```

---

## 约束类型对比表

| 约束类型 | 功能 | 约束值格式 | 前端效果 | 典型场景 |
|----------|------|------------|----------|----------|
| 值范围约束 | 限制取值范围 | `最小值,最大值` | 调整min/max | 编码方式影响码率范围 |
| 固定值约束 | 限制固定值 | `值1,值2,值3` | 只能取这几个值 | 只能选择特定的几个值 |
| 公式计算约束 | 自动计算 | `公式表达式` | 自动计算，只读 | 符号率=数据率/2 |
| 枚举限制约束 | 限制枚举选项 | `值1,值2,值3` | 其他选项置灰 | 下拉框部分选项可用 |
| 控件禁用约束 | 禁用控件 | 留空 | 控件置灰 | ACM启用时禁用手动设置 |

## 配置示例

### 示例1：编码方式影响码率范围
```
约束类型：值范围约束
源参数：编码方式 (ENC_CODE_TYPE)
目标参数：编码码率 (ENC_CODE_RATE)
约束条件：==CONV
约束值：0.5,0.8

效果：当编码方式为CONV时，码率范围为0.5~0.8
```

### 示例2：编码方式限制码率固定值
```
约束类型：固定值约束
源参数：编码方式 (ENC_CODE_TYPE)
目标参数：编码码率 (ENC_CODE_RATE)
约束条件：==CONV
约束值：0.5,0.67,0.75

效果：当编码方式为CONV时，码率只能选择0.5、0.67或0.75
```

### 示例3：数据率自动计算符号率
```
约束类型：公式计算约束
源参数：数据率 (DATA_RATE)
目标参数：符号率 (SYMBOL_RATE)
约束条件：（留空）
约束值：source / 2

效果：符号率 = 数据率 / 2（自动计算）
```

### 示例4：编码方式限制码率枚举选项
```
约束类型：枚举限制约束
源参数：编码方式 (ENC_CODE_TYPE)
目标参数：编码码率 (ENC_CODE_RATE)
约束条件：==CONV
约束值：0.5,0.67,0.75

效果：当编码方式为CONV时，码率下拉框只有0.5、0.67、0.75可选，其他置灰
```

### 示例5：ACM启用时禁用码率设置
```
约束类型：控件禁用约束
源参数：ACM使能 (ACM_ENABLE)
目标参数：编码码率 (ENC_CODE_RATE)
约束条件：==1
约束值：（留空）

效果：当ACM启用时，码率控件置灰不可操作
```

## 约束值输入智能化

### 值范围约束
```
目标参数：编码码率（浮点，0.33~0.95）

输入界面：
最小值：[0.5] ~ 最大值：[0.8]
       ↓
自动生成：0.5,0.8
```

### 固定值约束
```
目标参数：编码码率（枚举）

输入界面：
┌─────────────────────┐
│ [0.5, 0.67, 0.75] ▼ │
│ ☑ 0.5               │
│ ☑ 0.67              │
│ ☑ 0.75              │
└─────────────────────┘
       ↓
自动生成：0.5,0.67,0.75
```

### 公式计算约束
```
输入界面：
┌─────────────────────────┐
│ 公式 [source * 2      ] │
└─────────────────────────┘

提示：
- 支持的变量：source（源参数值）
- 支持的运算：+ - * / ( )
- 示例：source * 2 | source + 10
```

### 枚举限制约束
```
目标参数：编码码率（枚举）

输入界面：
┌─────────────────────┐
│ [0.5, 0.67, 0.75] ▼ │
│ ☑ 0.5               │
│ ☑ 0.67              │
│ ☑ 0.75              │
│ ☐ 0.8（置灰）       │
└─────────────────────┘
       ↓
自动生成：0.5,0.67,0.75
```

### 控件禁用约束
```
输入界面：
┌─────────────────────────┐
│ [留空即可]            🔒 │
└─────────────────────────┘
（输入框禁用状态）
```

## 优先级建议

| 约束类型 | 建议优先级 | 说明 |
|----------|------------|------|
| 控件禁用约束 | 20+ | 强制约束，最高优先级 |
| 公式计算约束 | 20+ | 自动计算，高优先级 |
| 固定值约束 | 15-19 | 重要约束 |
| 枚举限制约束 | 15-19 | 重要约束 |
| 值范围约束 | 10-14 | 一般约束 |

## 总结

✅ 5种约束类型覆盖所有场景
✅ 智能输入方式，减少错误
✅ 清晰的功能定义和使用场景
✅ 完整的配置示例
✅ 优先级机制保证正确执行

现在约束类型定义更加清晰和实用了！
