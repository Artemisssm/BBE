# 基带参数配置标题优化说明

## 问题描述

在打开多个基带单元的参数配置页面时，顶部导航栏的标签（Tags View）都显示"基带参数配置"，无法区分当前打开的是哪个单元的配置页面。

![问题示例](https://i.imgur.com/example.png)
```
[首页] [基带参数配置] [基带参数配置] [基带参数配置]
```
所有标签都显示相同的名称，无法区分。

## 优化方案

### 1. 顶部导航标签（Tags View）优化

**优化前**：
```
[首页] [基带参数配置] [基带参数配置] [基带参数配置]
```

**优化后**：
```
[首页] [板1-FPGA0 前向中低速-编码 [KSA]] [板2（整板） 返向高速-调制 [KMA]] [板3-FPGA1 小环-解调 [SSA]]
```

**标题格式**：`{板卡资源} {单元名称}-{单元类型} [{模式类型}]`

**优势**：
- 一眼就能看出是哪块板卡的哪个单元
- 包含单元类型和模式类型信息
- 多个标签时可以快速区分和切换

### 2. 浏览器标签页标题同步优化

浏览器标签页标题也会同步更新，格式：`{板卡资源} {单元名称}-{单元类型} [{模式类型}] | 基带参数配置`

### 3. 页面主标题优化

**优化前**：
```
基带参数配置
[编码]
```

**优化后**：
```
[板1-FPGA0] 前向中低速 [编码]
```

**显示内容**：
- 板卡资源（带背景高亮，使用等宽字体）
- 单元名称
- 单元类型（彩色标签）

**优势**：
- 页面顶部清晰显示当前配置的单元
- 板卡资源使用特殊样式突出显示
- 视觉层次分明

### 4. 详细信息展示

在主标题下方，继续显示完整的单元信息：
- 单元名称（带图标）
- 板卡资源（带图标）
- 模式类型（彩色标签）
- 版本信息（带图标）

## 实现细节

### 导入 TagsView Store

```javascript
import useTagsViewStore from '@/store/modules/tagsView'

const tagsViewStore = useTagsViewStore()
```

### 动态标题更新

```javascript
/** 更新页面标题和标签标题 */
function updatePageTitle() {
  if (unitInfo.value.unitName && unitInfo.value.unitType) {
    const unitTypeName = getUnitTypeName(unitInfo.value.unitType)
    const resource = formatResource(unitInfo.value.channelNo, unitInfo.value.unitName)
    const modeType = unitInfo.value.modeType ? ` [${unitInfo.value.modeType}]` : ''
    
    // 更新浏览器标题
    document.title = `${resource} ${unitInfo.value.unitName}-${unitTypeName}${modeType} | 基带参数配置`
    
    // 更新顶部标签标题
    const newTitle = `${resource} ${unitInfo.value.unitName}-${unitTypeName}${modeType}`
    const currentRoute = {
      ...route,
      meta: {
        ...route.meta,
        title: newTitle
      },
      title: newTitle
    }
    tagsViewStore.updateVisitedView(currentRoute)
  }
}
```

### 板卡资源格式化

```javascript
/** 格式化板卡资源显示 */
function formatResource(channelNo, unitName) {
  if (!channelNo) return '-'
  const boardNo = Math.floor((channelNo - 1) / fpgasPerBoard) + 1
  const fpgaNo = (channelNo - 1) % fpgasPerBoard
  
  if (unitName === '返向高速') {
    return `板${boardNo}（整板）`
  } else {
    return `板${boardNo}-FPGA${fpgaNo}`
  }
}
```

### 触发时机

- 页面加载完成后，获取单元信息时自动更新标题
- 单元信息变化时，通过 watch 监听自动更新

## 使用效果

### 场景1：打开单个参数配置页面
- 浏览器标签页显示：`板1-FPGA0 前向中低速-编码 [KSA] | 基带参数配置`
- 页面标题显示：`[板1-FPGA0] 前向中低速 [编码]`

### 场景2：同时打开多个参数配置页面

**顶部导航标签**：
```
[首页] [板1-FPGA0 前向中低速-编码 [KSA]] [板2（整板） 返向高速-调制 [KMA]] [板3-FPGA1 小环-解调 [SSA]]
```

每个标签都能清晰区分，点击即可快速切换。

### 场景3：标签宽度不足时
系统会自动截断标题，但由于重要信息（板卡资源、单元名称）在前面，仍然能够区分：
```
[板1-FPGA0 前向中低速-编...]  [板2（整板） 返向高速-...]  [板3-FPGA1 小环-解...]
```

鼠标悬停可以看到完整标题。

## 样式优化

### 板卡资源样式
```css
.title-resource {
  background: rgba(255, 255, 255, 0.25);
  padding: 4px 12px;
  border-radius: 6px;
  font-size: 18px;
  font-family: 'Courier New', monospace;
  font-weight: 700;
}
```

- 使用半透明白色背景突出显示
- 等宽字体（Courier New）让板卡编号对齐
- 圆角边框更美观

### 单元名称样式
```css
.title-unit {
  font-size: 22px;
}
```

- 字体稍小于板卡资源
- 保持清晰可读

## 核心优势

1. **快速识别**：在顶部导航栏一眼就能看出每个标签对应的单元
2. **快速切换**：点击标签即可在不同单元的配置页面间切换
3. **避免错误**：清晰的标识避免配置错误的单元
4. **提升效率**：特别适合需要同时配置多个基带单元的场景

## 总结

通过动态更新顶部导航标签（Tags View）的标题，用户可以：
- 在多个配置页面间快速识别和切换
- 清晰了解每个标签对应的板卡资源和单元信息
- 避免配置错误的单元
- 大幅提升多单元配置的工作效率

**关键技术点**：
- 使用 `useTagsViewStore().updateVisitedView()` 更新标签标题
- 在获取单元信息后立即更新标题
- 标题格式包含板卡资源、单元名称、单元类型、模式类型等关键信息
