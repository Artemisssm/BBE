# 字段不存在错误修复说明

## 🐛 错误信息
```
Unknown column 'pd.bit_length' in 'field list'
Unknown column 'pd.hardware_order' in 'field list'
```

## ✅ 问题原因
SQL映射文件中查询了数据库表中不存在的字段：
- `bit_length` - 表中不存在
- `hardware_order` - 表中不存在

## 🔍 实际表结构
根据实体类 `SysBasebandParamDef.java`，实际字段为：
- ✅ `bit_width_type` - 位宽类型（U8/U16/U32/I8/I16/I32）
- ✅ `sort_order` - 显示排序

## 🔧 修复内容

### 修改文件
`RuoYi-Vue/ruoyi-system/src/main/resources/mapper/system/SysBasebandMacroParamMapper.xml`

### 修改前
```xml
SELECT 
    ...
    pd.bit_length AS bitLength,
    pd.default_value AS `defaultValue`,
    pd.hardware_order AS hardwareOrder
FROM sys_baseband_macro_param mp
LEFT JOIN sys_baseband_param_def pd ON mp.param_id = pd.param_id
WHERE mp.macro_id = #{macroId}
ORDER BY pd.hardware_order
```

### 修改后
```xml
SELECT 
    ...
    pd.default_value AS `defaultValue`,
    pd.bit_width_type AS bitWidthType,
    pd.sort_order AS sortOrder
FROM sys_baseband_macro_param mp
LEFT JOIN sys_baseband_param_def pd ON mp.param_id = pd.param_id
WHERE mp.macro_id = #{macroId}
ORDER BY pd.sort_order
```

## 📋 完整的字段映射

| 数据库字段 | Java字段 | 类型 | 说明 |
|-----------|---------|------|------|
| param_id | paramId | Long | 参数ID |
| unit_type | unitType | String | 单元类型 |
| param_code | paramCode | String | 参数编码 |
| param_name | paramName | String | 参数名称 |
| value_type | valueType | String | 值类型 |
| enum_options | enumOptions | String | 枚举选项 |
| min_value | minValue | BigDecimal | 最小值 |
| max_value | maxValue | BigDecimal | 最大值 |
| quantization_unit | quantizationUnit | Integer | 量化单位 |
| bit_width_type | bitWidthType | String | 位宽类型 |
| sort_order | sortOrder | Integer | 排序 |
| step_value | stepValue | BigDecimal | 步进值 |
| default_value | defaultValue | String | 默认值 |

## 🚀 使修复生效

### 方法1：重新编译
```bash
cd RuoYi-Vue
mvn clean compile
```

### 方法2：完整重启
```bash
cd RuoYi-Vue/ruoyi-admin
mvn clean package -DskipTests
# 然后在IDE中重新运行 RuoYiApplication.java
```

### 方法3：使用批处理脚本
```bash
重启后端服务.bat
```

## ✅ 验证步骤
1. 重启后端服务
2. 登录系统
3. 进入：基带监控 > 宏管理
4. 点击任意宏的"配置参数"按钮
5. 应该能正常打开参数配置对话框并显示参数列表

## 💡 经验总结

### 如何避免此类错误？

1. **保持一致性**
   - 数据库表结构
   - Java实体类字段
   - MyBatis XML映射
   - 前端API调用

2. **修改字段时的检查清单**
   - [ ] 数据库表结构已更新
   - [ ] 实体类字段已同步
   - [ ] Mapper XML已更新
   - [ ] Service层代码已调整
   - [ ] Controller接口已修改
   - [ ] 前端API已更新

3. **快速定位问题**
   ```
   错误：Unknown column 'xxx' in 'field list'
   ↓
   检查：数据库表是否有该字段
   ↓
   检查：实体类是否有对应属性
   ↓
   修复：删除不存在的字段 或 添加缺失的字段
   ```

## 🔍 相关文件

- 实体类：`RuoYi-Vue/ruoyi-system/src/main/java/com/ruoyi/system/domain/SysBasebandParamDef.java`
- Mapper XML：`RuoYi-Vue/ruoyi-system/src/main/resources/mapper/system/SysBasebandMacroParamMapper.xml`
- 数据库脚本：`RuoYi-Vue/sql/完整导入参数.sql`

---

**修复日期**：2025-12-09  
**修复人员**：Kiro AI  
**状态**：✅ 已修复，等待重启验证
