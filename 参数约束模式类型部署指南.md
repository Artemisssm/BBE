# 参数约束模式类型功能 - 快速部署指南

## 功能说明
为参数约束添加"模式类型"字段，支持通过勾选框选择约束适用的模式（KSA、KMA、SSA、基带数传）。不勾选表示适用所有模式。

## 部署步骤

### 第一步：执行数据库脚本

#### Windows环境（推荐）
```bash
cd RuoYi-Vue\sql
add_mode_types_to_constraint.bat
```

按提示输入MySQL密码即可。

#### 手动执行
```bash
mysql -h localhost -P 3306 -u root -p ry-vue < RuoYi-Vue/sql/add_mode_types_to_constraint.sql
```

#### 验证
执行后应该看到：
```
模式类型字段添加完成
```

可以通过以下SQL验证：
```sql
DESC sys_baseband_param_constraint;
```
应该能看到 `mode_types` 字段。

### 第二步：重新编译后端

#### 方式1：使用Maven
```bash
cd RuoYi-Vue
mvn clean package -DskipTests
```

#### 方式2：使用IDEA
1. 打开 Maven 面板
2. 点击 clean
3. 点击 package
4. 勾选 Skip Tests

### 第三步：重启后端服务

#### 停止现有服务
找到正在运行的 Java 进程并停止。

#### 启动新服务

**Windows:**
```bash
cd RuoYi-Vue\ruoyi-admin\target
java -jar ruoyi-admin.jar
```

**Linux:**
```bash
cd RuoYi-Vue/ruoyi-admin/target
nohup java -jar ruoyi-admin.jar > output.log 2>&1 &
```

### 第四步：验证功能

1. 打开浏览器访问系统
2. 进入"系统管理" → "参数约束"
3. 点击"新增"按钮
4. 应该能看到"适用模式类型"勾选框：
   - □ KSA
   - □ KMA
   - □ SSA
   - □ 基带数传
5. 列表中应该显示"模式类型"列

## 功能使用

### 创建通用约束（推荐）
大部分约束在不同模式下相同，不需要勾选任何模式：
1. 填写约束信息
2. **不勾选**任何模式类型
3. 保存

→ 该约束将适用于所有模式

### 创建特定模式约束
仅在特定模式下生效的约束：
1. 填写约束信息
2. **勾选**需要的模式类型（如：KSA）
3. 保存

→ 该约束仅在KSA模式下生效

### 创建多模式约束
在多个模式下生效的约束：
1. 填写约束信息
2. **勾选**多个模式类型（如：KSA + KMA）
3. 保存

→ 该约束在KSA和KMA模式下生效

## 常见问题

### Q1: 数据库脚本执行失败
**A:** 检查：
- MySQL服务是否启动
- 数据库名称是否正确（默认：ry-vue）
- 用户名密码是否正确
- 是否有足够的权限

### Q2: 后端编译失败
**A:** 检查：
- JDK版本是否正确（需要JDK 8+）
- Maven配置是否正确
- 依赖是否下载完整

### Q3: 前端看不到新功能
**A:** 
- 刷新浏览器（Ctrl+F5 强制刷新）
- 清除浏览器缓存
- 检查后端服务是否正常启动

### Q4: 已有约束数据会怎样？
**A:** 
- 已有约束的 `mode_types` 字段为空
- 表示适用于所有模式
- 完全向后兼容，无需修改

### Q5: 如何修改已有约束？
**A:**
1. 在列表中点击"修改"
2. 勾选需要的模式类型
3. 保存即可

## 回滚方案

如果需要回滚此功能：

### 1. 删除数据库字段
```sql
ALTER TABLE sys_baseband_param_constraint DROP COLUMN mode_types;
```

### 2. 恢复代码
使用Git恢复到之前的版本：
```bash
git checkout HEAD~1 -- RuoYi-Vue/ruoyi-system/src/main/java/com/ruoyi/system/domain/SysBasebandParamConstraint.java
git checkout HEAD~1 -- RuoYi-Vue/ruoyi-system/src/main/resources/mapper/system/SysBasebandParamConstraintMapper.xml
git checkout HEAD~1 -- RuoYi-Vue3/src/views/system/baseband/paramConstraint/index.vue
```

### 3. 重新编译和重启
按照部署步骤重新编译和重启服务。

## 技术支持

如有问题，请查看：
- `参数约束模式类型功能说明.md` - 详细功能说明
- 系统日志：`RuoYi-Vue/logs/`
- 浏览器控制台（F12）

## 更新记录
- 2024-12-02：初始版本，添加模式类型支持
