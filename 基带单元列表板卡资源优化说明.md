# 基带单元列表板卡资源优化说明

## 优化概述

将板卡资源列移到表格最前面，并通过颜色、样式等视觉手段，让用户能够一眼看出哪些单元分布在同一块FPGA或同一块板上。

## 主要优化内容

### 1. 列顺序调整

**优化前**：
```
[序号] [单元名称] [单元类型] [模式类型] [板卡资源] [版本] [状态] [备注] [创建时间] [操作]
```

**优化后**：
```
[序号] [板卡资源] [单元名称] [单元类型] [模式类型] [版本] [状态] [备注] [创建时间] [操作]
```

**优势**：
- 板卡资源作为最重要的分组依据，放在最前面
- 便于快速定位和识别单元分布
- 符合从硬件到软件的查看逻辑

### 2. 板卡资源视觉增强

#### 渐变色徽章设计
每个板卡资源显示为一个渐变色徽章，包含：
- **板卡编号**：如"板1"、"板2"（大字体，粗体）
- **FPGA信息**：如"FPGA0"、"FPGA1"或"整板"（小字体）
- **图标**：CPU图标表示硬件资源

#### 不同板卡的颜色区分
- **板1**：紫色渐变（#667eea → #764ba2）
- **板2**：粉红渐变（#f093fb → #f5576c）
- **板3**：蓝色渐变（#4facfe → #00f2fe）
- **板4**：绿色渐变（#43e97b → #38f9d7）

#### 整板占用特殊标识
- 返向高速等占用整板的单元，徽章带有白色边框
- 显示"整板"而不是具体的FPGA编号
- 更粗的字体和更强的阴影

### 3. 表格行背景色

同一块板上的所有单元，行背景色使用对应板卡的浅色：
- **板1的单元**：淡紫色背景
- **板2的单元**：淡粉色背景
- **板3的单元**：淡蓝色背景
- **板4的单元**：淡绿色背景

**效果**：
- 同一块板的单元形成视觉分组
- 鼠标悬停时背景色加深
- 快速识别板卡分布情况

### 4. 排序功能

板卡资源列支持排序：
- 点击列标题可按板卡资源排序
- 自动按照板卡编号和FPGA编号排序
- 便于查看资源使用情况

### 5. 紧凑布局

优化了间距和尺寸：
- 徽章高度更紧凑（padding: 4px 10px）
- 表格行高减小（padding: 8px 0）
- 字体大小适中（板卡13px，FPGA 10px）
- 整体更紧凑，信息密度更高

## 视觉效果示例

### 示例1：多个单元分布在不同板卡

```
┌────────────────────────────────────────────────────────┐
│ 序号 │ 板卡资源        │ 单元名称    │ 单元类型 │ ... │
├────────────────────────────────────────────────────────┤
│  1   │ [板1]          │ 前向中低速  │ 编码     │ ... │ ← 淡紫色背景
│      │ FPGA0          │             │          │     │
├────────────────────────────────────────────────────────┤
│  2   │ [板1]          │ 前向中低速  │ 调制     │ ... │ ← 淡紫色背景
│      │ FPGA0          │             │          │     │
├────────────────────────────────────────────────────────┤
│  3   │ [板2]          │ 返向高速    │ 编码     │ ... │ ← 淡粉色背景
│      │ 整板           │             │          │     │
├────────────────────────────────────────────────────────┤
│  4   │ [板3]          │ 小环        │ 解调     │ ... │ ← 淡蓝色背景
│      │ FPGA1          │             │          │     │
└────────────────────────────────────────────────────────┘
```

### 示例2：同一FPGA上的多个单元

```
┌────────────────────────────────────────────────────────┐
│  1   │ [板1]          │ 前向中低速  │ 编码     │ ... │ ← 同色背景
│      │ FPGA0          │             │          │     │
├────────────────────────────────────────────────────────┤
│  2   │ [板1]          │ 前向中低速  │ 调制     │ ... │ ← 同色背景
│      │ FPGA0          │             │          │     │
├────────────────────────────────────────────────────────┤
│  3   │ [板1]          │ 前向中低速  │ 解调     │ ... │ ← 同色背景
│      │ FPGA0          │             │          │     │
└────────────────────────────────────────────────────────┘
```

一眼就能看出这三个单元都在板1的FPGA0上。

## 技术实现

### 1. 动态样式类

```javascript
/** 获取资源徽章样式类 */
function getResourceBadgeClass(channelNo, unitName) {
  const boardNo = Math.floor((channelNo - 1) / fpgasPerBoard) + 1
  const fpgaNo = (channelNo - 1) % fpgasPerBoard
  
  if (unitName === '返向高速') {
    return `board-${boardNo} full-board`
  }
  return `board-${boardNo} fpga-${fpgaNo}`
}

/** 获取表格行样式类 */
function getRowClassName({ row }) {
  const boardNo = Math.floor((row.channelNo - 1) / fpgasPerBoard) + 1
  const fpgaNo = (row.channelNo - 1) % fpgasPerBoard
  return `board-row-${boardNo} fpga-row-${fpgaNo}`
}
```

### 2. 板卡信息分离显示

```javascript
/** 获取板卡编号 */
function getBoardInfo(channelNo) {
  const boardNo = Math.floor((channelNo - 1) / fpgasPerBoard) + 1
  return `板${boardNo}`
}

/** 获取FPGA信息 */
function getFpgaInfo(channelNo, unitName) {
  if (unitName === '返向高速') {
    return '整板'
  }
  const fpgaNo = (channelNo - 1) % fpgasPerBoard
  return `FPGA${fpgaNo}`
}
```

### 3. 排序支持

```javascript
/** 板卡资源排序方法 */
function sortByResource(a, b) {
  return a.channelNo - b.channelNo
}
```

在表格列定义中添加：
```vue
<el-table-column 
  label="板卡资源" 
  sortable 
  :sort-method="sortByResource"
>
```

## 使用场景

### 场景1：查看资源分布
快速了解哪些板卡已经被使用，哪些还有空闲资源。

### 场景2：定位同板单元
需要配置同一块板上的所有单元时，通过颜色快速定位。

### 场景3：避免资源冲突
添加新单元前，查看目标板卡的使用情况，避免资源冲突。

### 场景4：故障排查
某块板卡出现问题时，快速找到所有相关的单元。

## 优势总结

1. **视觉分组明确**：同一块板的单元通过颜色自然分组
2. **信息层次清晰**：板卡编号大而醒目，FPGA信息小而精确
3. **快速识别**：不同板卡使用不同颜色，一眼就能区分
4. **整板标识**：占用整板的单元有特殊标识，避免误操作
5. **紧凑高效**：优化后的布局更紧凑，可以在一屏内显示更多单元
6. **交互友好**：悬停效果、排序功能等提升用户体验

## 扩展性

如果将来需要支持更多板卡（如8块板），只需要添加对应的颜色样式：

```css
.resource-badge.board-5 {
  background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
}

:deep(.el-table__row.board-row-5) {
  background-color: rgba(250, 112, 154, 0.03);
}
```

系统会自动应用新的颜色方案。
