# 基带单元批量创建顺序优化说明

## 问题描述

在批量添加基带单元时，如果同时选择多个单元类型（编码、调制、解调、译码），创建的顺序是不确定的，取决于用户勾选的顺序。这导致：
1. 列表中的单元顺序混乱
2. 不便于查找和管理
3. 不符合信号处理的逻辑顺序

## 优化方案

### 固定创建顺序

无论用户以什么顺序勾选单元类型，系统都会按照以下固定顺序创建：

```
1. ENCODE（编码）
2. MODULATE（调制）
3. DEMODULATE（解调）
4. DECODE（译码）
```

这个顺序符合信号处理的逻辑流程：
- **发送端**：编码 -> 调制
- **接收端**：解调 -> 译码

### 实现方式

#### 1. 定义固定顺序

```javascript
// 定义固定的单元类型顺序：编码 -> 调制 -> 解调 -> 译码
const unitTypeOrder = ['ENCODE', 'MODULATE', 'DEMODULATE', 'DECODE']
```

#### 2. 按顺序过滤

```javascript
// 按照固定顺序过滤出用户选择的类型
const orderedUnitTypes = unitTypeOrder.filter(type => form.value.unitTypes.includes(type))
```

#### 3. 串行创建

使用 `async/await` 确保按顺序创建，而不是并行创建：

```javascript
// 按顺序创建单元（使用串行方式确保顺序）
const createUnitsSequentially = async () => {
  for (const unitType of orderedUnitTypes) {
    const unitData = {
      unitName: form.value.unitName,
      unitType: unitType,
      channelNo: form.value.channelNo,
      modeType: form.value.modeType,
      status: form.value.status,
      version: form.value.version,
      remark: form.value.remark
    }
    await addBasebandUnit(unitData)
  }
}
```

## 使用示例

### 示例1：选择全部四个类型

**用户操作**：
- 勾选顺序：解调 -> 编码 -> 译码 -> 调制（随意顺序）

**创建结果**：
```
1. 前向中低速 - 编码
2. 前向中低速 - 调制
3. 前向中低速 - 解调
4. 前向中低速 - 译码
```

### 示例2：只选择部分类型

**用户操作**：
- 勾选顺序：译码 -> 编码（随意顺序）

**创建结果**：
```
1. 前向中低速 - 编码
2. 前向中低速 - 译码
```

### 示例3：不同单元名称

**场景A - 前向中低速**：
```
1. 前向中低速 - 编码
2. 前向中低速 - 调制
3. 前向中低速 - 解调
4. 前向中低速 - 译码
```

**场景B - 返向高速**：
```
5. 返向高速 - 编码
6. 返向高速 - 调制
7. 返向高速 - 解调
8. 返向高速 - 译码
```

## 优势

### 1. 列表顺序一致
所有同一单元名称的不同类型，都按照固定顺序排列，便于查找。

### 2. 符合逻辑
按照信号处理的逻辑顺序排列：
- 发送端：编码 -> 调制
- 接收端：解调 -> 译码

### 3. 便于管理
- 快速定位特定类型的单元
- 批量操作时顺序可预测
- 配置参数时不会混淆

### 4. 用户友好
- 用户不需要关心勾选顺序
- 系统自动按照最合理的顺序创建
- 减少人为错误

## 技术细节

### 串行 vs 并行

**优化前（并行创建）**：
```javascript
const promises = []
unitTypes.forEach(unitType => {
  promises.push(addBasebandUnit(unitData))
})
Promise.all(promises) // 同时发送所有请求
```
- 优点：速度快
- 缺点：顺序不确定，取决于服务器响应速度

**优化后（串行创建）**：
```javascript
for (const unitType of orderedUnitTypes) {
  await addBasebandUnit(unitData) // 等待上一个完成再创建下一个
}
```
- 优点：顺序确定，符合预期
- 缺点：速度稍慢（但对于少量单元影响不大）

### 性能考虑

对于批量创建4个单元的场景：
- 并行方式：约1秒（4个请求同时发送）
- 串行方式：约2-3秒（4个请求依次发送）

考虑到：
1. 批量创建不是高频操作
2. 顺序的重要性大于速度
3. 用户体验更好

因此选择串行方式是合理的。

## 扩展性

如果将来需要添加新的单元类型，只需要在 `unitTypeOrder` 数组中添加即可：

```javascript
const unitTypeOrder = [
  'ENCODE',      // 编码
  'MODULATE',    // 调制
  'DEMODULATE',  // 解调
  'DECODE',      // 译码
  'NEW_TYPE'     // 新类型
]
```

## 总结

通过固定批量创建的顺序，确保了：
1. 列表中单元的排列顺序一致且可预测
2. 符合信号处理的逻辑流程
3. 便于用户查找和管理
4. 减少人为错误

这个优化提升了系统的专业性和用户体验。
