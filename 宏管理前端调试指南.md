# 宏管理前端调试指南

## 🐛 问题：点击宏管理界面卡住

### 症状
- 点击"基带监控 > 宏管理"后界面没有刷新
- 页面卡住，没有加载数据
- 浏览器没有发送API请求

### 🔍 已修复的问题

#### 问题1：API函数名称错误
**错误代码**：
```javascript
import { listBasebandParam } from '@/api/system/baseband/paramDef'
```

**正确代码**：
```javascript
import { listBasebandParamDef } from '@/api/system/baseband/paramDef'
```

**修复位置**：
- `RuoYi-Vue3/src/views/system/baseband/macro/index.vue` 第255行

#### 问题2：函数调用错误
**错误代码**：
```javascript
listBasebandParam(query).then(response => {
```

**正确代码**：
```javascript
listBasebandParamDef(query).then(response => {
```

**修复位置**：
- `RuoYi-Vue3/src/views/system/baseband/macro/index.vue` 第408行

## 🔧 调试步骤

### 1. 清除浏览器缓存
```
1. 按 Ctrl+Shift+Delete
2. 选择"缓存的图片和文件"
3. 点击"清除数据"
4. 按 Ctrl+F5 强制刷新
```

### 2. 检查浏览器Console
```
1. 按 F12 打开开发者工具
2. 切换到 Console 标签
3. 刷新页面
4. 查看是否有错误信息
```

**常见错误**：
- `Cannot read property 'xxx' of undefined` - 变量未定义
- `xxx is not a function` - 函数不存在
- `Failed to fetch` - 网络请求失败
- `404 Not Found` - 接口不存在

### 3. 检查Network请求
```
1. 按 F12 打开开发者工具
2. 切换到 Network 标签
3. 点击"宏管理"菜单
4. 查看是否有 /system/basebandMacro/list 请求
```

**预期结果**：
- 应该看到一个 GET 请求到 `/system/basebandMacro/list`
- 状态码应该是 200
- 响应应该是 JSON 格式

**如果没有请求**：
- 说明前端代码有错误，阻止了请求发送
- 检查 Console 是否有错误

**如果请求失败**：
- 404：后端接口不存在
- 500：后端代码错误
- 401/403：权限不足

### 4. 验证后端接口
在浏览器中直接访问：
```
http://localhost:8080/system/basebandMacro/list?pageNum=1&pageSize=10
```

**预期响应**：
```json
{
  "total": 0,
  "rows": [],
  "code": 200,
  "msg": "查询成功"
}
```

**如果返回401**：
- 需要先登录系统
- 或者在Postman中添加Token

**如果返回404**：
- 后端Controller没有正确配置
- 检查 `SysBasebandMacroController.java`

**如果返回500**：
- 后端代码有错误
- 查看后端日志

## 🧪 测试清单

### 前端测试
- [ ] 清除浏览器缓存
- [ ] 刷新页面（Ctrl+F5）
- [ ] 打开开发者工具（F12）
- [ ] 检查Console是否有错误
- [ ] 检查Network是否有请求
- [ ] 验证API函数名称正确

### 后端测试
- [ ] 后端服务正在运行
- [ ] 访问 `/system/basebandMacro/list` 返回200
- [ ] 数据库表 `sys_baseband_macro` 存在
- [ ] Controller类有 `@RestController` 注解
- [ ] 方法有 `@GetMapping("/list")` 注解

### 数据库测试
```sql
-- 检查表是否存在
SHOW TABLES LIKE 'sys_baseband_macro';

-- 检查表结构
DESC sys_baseband_macro;

-- 查询数据
SELECT * FROM sys_baseband_macro;
```

## 📝 完整的验证流程

### 步骤1：验证文件存在
```bash
# 检查前端文件
ls RuoYi-Vue3/src/views/system/baseband/macro/index.vue
ls RuoYi-Vue3/src/api/system/baseband/macro.js

# 检查后端文件
ls RuoYi-Vue/ruoyi-admin/src/main/java/com/ruoyi/web/controller/system/SysBasebandMacroController.java
```

### 步骤2：验证代码正确性
```javascript
// 检查 macro/index.vue 的导入
import { listBasebandParamDef } from '@/api/system/baseband/paramDef'  // ✅ 正确

// 检查函数调用
listBasebandParamDef(query).then(response => {  // ✅ 正确
```

### 步骤3：重启服务
```bash
# 重启后端
cd RuoYi-Vue/ruoyi-admin
mvn spring-boot:run

# 重启前端（如果使用开发服务器）
cd RuoYi-Vue3
npm run dev
```

### 步骤4：清除缓存并测试
1. 清除浏览器缓存
2. 关闭所有浏览器标签
3. 重新打开浏览器
4. 登录系统
5. 点击"基带监控 > 宏管理"
6. 观察页面是否正常加载

## 🎯 预期结果

### 正常情况
1. 点击"宏管理"后，页面立即跳转
2. 显示宏管理页面（可能是空列表）
3. Console没有错误
4. Network有 `/system/basebandMacro/list` 请求
5. 请求返回200状态码

### 页面应该显示
```
┌─────────────────────────────────────────┐
│ 宏管理                                   │
├─────────────────────────────────────────┤
│ 搜索栏：宏名称 [____] 单元类型 [▼] ...  │
├─────────────────────────────────────────┤
│ [新增] [修改] [删除]                     │
├─────────────────────────────────────────┤
│ 表格（可能为空）                         │
│ 暂无数据                                 │
└─────────────────────────────────────────┘
```

## 🚨 如果仍然有问题

### 收集以下信息

1. **浏览器Console错误**
```
按F12 > Console标签 > 截图或复制错误信息
```

2. **Network请求详情**
```
按F12 > Network标签 > 找到失败的请求 > 截图
```

3. **后端日志**
```bash
# 查看后端日志
tail -f RuoYi-Vue/ruoyi-admin/logs/sys-info.log
```

4. **数据库状态**
```sql
-- 检查表
SHOW TABLES LIKE '%macro%';

-- 检查菜单
SELECT * FROM sys_menu WHERE menu_name = '宏管理';
```

## 💡 常见解决方案

### 方案1：完全重新部署
```bash
# 1. 清理数据库
mysql -uroot -p ry-vue < fix_macro_menu.sql

# 2. 重启后端
cd RuoYi-Vue/ruoyi-admin
mvn clean package
mvn spring-boot:run

# 3. 清除前端缓存
rm -rf RuoYi-Vue3/node_modules/.vite
rm -rf RuoYi-Vue3/dist

# 4. 重启前端
cd RuoYi-Vue3
npm run dev

# 5. 清除浏览器缓存并重新登录
```

### 方案2：使用简化版页面测试
创建一个最简单的测试页面：

```vue
<template>
  <div>
    <h1>宏管理测试页面</h1>
    <button @click="testApi">测试API</button>
    <pre>{{ result }}</pre>
  </div>
</template>

<script setup>
import { ref } from 'vue'
import { listMacro } from '@/api/system/baseband/macro'

const result = ref('')

function testApi() {
  listMacro({ pageNum: 1, pageSize: 10 })
    .then(response => {
      result.value = JSON.stringify(response, null, 2)
    })
    .catch(error => {
      result.value = 'Error: ' + error.message
    })
}
</script>
```

保存为 `RuoYi-Vue3/src/views/test/macro-test.vue`

然后在浏览器中访问：`http://localhost/test/macro-test`

## 📞 技术支持

如果按照以上步骤仍然无法解决，请提供：
1. 浏览器Console的完整错误信息
2. Network标签中的请求详情
3. 后端日志中的错误信息
4. 数据库查询结果

---

**文档版本**：v1.0  
**更新日期**：2025-12-09  
**适用场景**：宏管理前端调试
